!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).scrollwow=t()}(this,function(){"use strict";return function(){let e={},t=["stepAbove","stepBelow"],n=!1,o=0,r=0,i=0,s=0,c="down",l=!1,p=[],u={},f=[],a=[],d={stepEnter:()=>{},stepExit:()=>{}};function x(){c=window.pageYOffset>s?"down":"up",s=window.pageYOffset}function E(e){return+e.getAttribute("data-scroll-index")}function b(e){u[e]&&u[e].forEach(e=>e.disconnect())}function m(e){let t=E(e);a[t].state="enter",a[t].direction=c,d.stepEnter&&!f[t]&&(d.stepEnter({element:e,index:t,direction:c}),n&&(f[t]=!0))}function w(e){let t=E(e);a[t].state="exit",a[t].direction=c,d.stepExit&&d.stepExit({element:e,index:t,direction:c})}function g([e]){x();let{isIntersecting:t,boundingClientRect:{top:n,bottom:o},target:r}=e,s=n-i,l=o-i,p=E(r),u=a[p];s<=0&&l>=0&&t&&"down"===c&&"enter"!==u.state&&m(r),s>=0&&!t&&"up"===c&&"enter"===u.state&&w(r)}function h([e]){x();let{isIntersecting:t,boundingClientRect:{top:n,bottom:o},target:r}=e,s=n-i,l=o-i,p=E(r),u=a[p];s<0&&l>=0&&t&&"up"===c&&"enter"!==u.state&&m(r),l<=0&&!t&&"down"===c&&"enter"===u.state&&w(r)}function y(e){if(e&&!l)return t.forEach(b),u.stepAbove=p.map(e=>{let t=new IntersectionObserver(g,{rootMargin:`${r-o}px 0px ${i-o}px`});return t.observe(e),t}),u.stepBelow=p.map(e=>{let t=new IntersectionObserver(h,{rootMargin:`${-i}px 0px ${r-o}px`});return t.observe(e),t}),l=!0,!0;t.forEach(b),l=!1}return e.setup=({step:t,offset:s=.5,once:c=!1})=>(p=Array.from(document.querySelectorAll(t)),n=c,p.forEach((e,t)=>e.setAttribute("data-scroll-index",t)),function(e){e=Math.min(Math.max(0,e),1),o=window.innerHeight,r=document.documentElement.scrollHeight,i=e*o,a=p.map(()=>({direction:null,state:null}))}(s),e.enable(),e),e.enable=()=>(y(!0),e),e.disable=()=>(y(!1),e),e.onStepEnter=t=>("function"!=typeof t?console.error("onStepEnter需要接收一个函数！"):d.stepEnter=t,e),e.onStepExit=t=>("function"!=typeof t?console.error("onStepExit需要接收一个函数！"):d.stepExit=t,e),e.destroy=()=>{y(!1),Object.keys(d).forEach(e=>d[e]=null),Object.keys(u).forEach(e=>u[e]=null)},e}});
